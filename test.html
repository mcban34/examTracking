<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <!-- HTML -->
    <table id="myTable">
        <tr>
            <th>Name</th>
            <th>Age</th>
            <th>Email</th>
        </tr>
        <tr>
            <td>John Doe</td>
            <td>30</td>
            <td>john@example.com</td>
        </tr>
        <tr>
            <td>Jane Smith</td>
            <td>25</td>
            <td>jane@example.com</td>
        </tr>
    </table>

    <button onclick="exportToExcel()">Export to Excel</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

    <script>
        // JavaScript
        function exportToExcel() {
            const table = document.getElementById("myTable");
            const rows = table.getElementsByTagName("tr");
            const data = [];

            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                const cells = row.getElementsByTagName("td");
                const rowData = [];

                for (let j = 0; j < cells.length; j++) {
                    rowData.push(cells[j].innerText);
                }

                data.push(rowData);
            }

            const worksheet = XLSX.utils.aoa_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Sheet1");

            // Dosya adını ve türünü belirleyin
            const fileName = "myData.xlsx";
            const fileType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";

            // Dosyayı indirme bağlantısını oluşturun ve tıklayın
            const blob = new Blob([s2ab(XLSX.write(workbook, { bookType: "xlsx", type: "binary" }))], {
                type: fileType,
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Yardımcı fonksiyon: string to array buffer
        function s2ab(s) {
            const buf = new ArrayBuffer(s.length);
            const view = new Uint8Array(buf);
            for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff;
            return buf;
        }

    </script>



</body>

</html>